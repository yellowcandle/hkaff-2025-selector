class u{detectConflicts(e){const t=[];for(let n=0;n<e.length;n++)for(let a=n+1;a<e.length;a++){const i=e[n].screening_snapshot,s=e[a].screening_snapshot,o=new Date(i.datetime).getTime(),r=o+i.duration_minutes*6e4,_=new Date(s.datetime).getTime(),l=_+s.duration_minutes*6e4,d=Math.max(o,_),m=Math.min(r,l),c=Math.max(0,m-d)/6e4;c>0?t.push({screening_a:e[n],screening_b:e[a],overlap_minutes:c,severity:"impossible"}):i.venue_name_en!==s.venue_name_en&&Math.abs(_-r)<18e5&&t.push({screening_a:e[n],screening_b:e[a],overlap_minutes:0,severity:"warning"})}return t}wouldConflict(e,t){const n={screening_id:t.id,added_at:new Date().toISOString(),film_snapshot:{id:t.film_id,title_tc:"",title_en:"",poster_url:""},screening_snapshot:{id:t.id,datetime:t.datetime,duration_minutes:t.duration_minutes,venue_name_tc:"",venue_name_en:""}},a=[...e,n];return this.detectConflicts(a).filter(s=>s.screening_a.screening_id===t.id||s.screening_b.screening_id===t.id)}calculateOverlap(e,t){const n=new Date(e.datetime).getTime(),a=n+e.duration_minutes*6e4,i=new Date(t.datetime).getTime(),s=i+t.duration_minutes*6e4,o=Math.max(n,i),r=Math.min(a,s);return Math.max(0,r-o)/6e4}hasOverlap(e,t){return this.calculateOverlap(e,t)>0}}const v=new u;export{v as c};
